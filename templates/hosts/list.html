{% extends "layouts/base.html" %}

{% block title %}Hosts - Myriad{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Hosts</h1>
    <div class="d-flex gap-1">
        <button class="btn" hx-post="/hosts/sync" hx-swap="none" hx-on::after-request="htmx.trigger('#hosts-table', 'refresh')">
            Sync Now
        </button>
    </div>
</div>

<div class="card mb-2">
    <form class="d-flex gap-2" style="flex-wrap: wrap;">
        <div class="form-group mb-0">
            <label class="form-label" for="location">Location</label>
            <select id="location" name="location" class="form-control"
                    hx-get="/hosts/table" hx-target="#hosts-table" hx-trigger="change"
                    hx-include="[name='status']">
                <option value="">All Locations</option>
                {% for loc in locations %}
                <option value="{{ loc.id }}" {% if current_location == loc.id %}selected{% endif %}>{{ loc.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group mb-0">
            <label class="form-label" for="status">Status</label>
            <select id="status" name="status" class="form-control"
                    hx-get="/hosts/table" hx-target="#hosts-table" hx-trigger="change"
                    hx-include="[name='location']">
                <option value="">All Statuses</option>
                <option value="online" {% if current_status == 'online' %}selected{% endif %}>Online</option>
                <option value="offline" {% if current_status == 'offline' %}selected{% endif %}>Offline</option>
                <option value="unknown" {% if current_status == 'unknown' %}selected{% endif %}>Unknown</option>
            </select>
        </div>
    </form>
</div>

<div class="card">
    <div id="hosts-table" hx-get="/hosts/table" hx-trigger="refresh from:body">
        {% include "hosts/_table.html" %}
    </div>
</div>
{% endblock %}
